René Witte Lecture 7 Machine Learning Primer Machine Learning for Intelligent Systems History ML Types Process Introduction, Clustering, Classiﬁcation, Regression, Evaluation Clustering Documents Motivation COMP 474/6741, Winter 2022 k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading René Witte Department of Computer Science and Software Engineering Concordia University 7.1 BreakPage Outline René Witte 1 Machine Learning Primer History ML Types Machine Learning Primer Process History ML Types 2 Clustering Documents Process Motivation Clustering Documents Motivation k-Means Clustering k-Means Clustering Application Example Application Example Classiﬁcations & 3 Classiﬁcations & Predictions Predictions Introduction Introduction Classiﬁcation with kNN Regression with kNN Classiﬁcation with kNN Machine Learning Regression with kNN Evaluation Evaluation Methodology 4 Machine Learning Evaluation Evaluation Metrics Error Analysis Evaluation Methodology Overﬁtting Underﬁtting Evaluation Metrics Cross-Validation Error Analysis Notes and Further Reading Overﬁtting Underﬁtting Cross-Validation 5 Notes and Further Reading 7.2 BreakPage AI, ML, DL René Witte Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading https://medium.com/machine-learning-for-humans/neural-networks-deep-learning-cdad8aeae49b 7.3 BreakPage History René Witte Learn from experience Machine Learning In 1959, Arthur Samuel ﬁrst proposed the concept Primer Machine Learning: History ML Types Process “A computer program is said to learn from Clustering Documents experience E with respect to some class of tasks Motivation k-Means Clustering T and performance measure P if its performance Application Example at tasks in T, as measured by P, improves with Classiﬁcations & Predictions experience E.” Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading 7.4 BreakPage Automated Reasoning René Witte Machine Learning Primer History ML Types Process Clustering Documents Inference Motivation Process of deriving new facts from a set of premises k-Means Clustering Application Example Classiﬁcations & Types of logical inference Predictions Introduction Classiﬁcation with kNN 1 Deduction Regression with kNN 2 Abduction MEvaaclhuianteioLnearning Evaluation Methodology 3 Induction Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading 7.5 BreakPage Deduction René Witte Machine Learning Primer History ML Types aka Natural Deduction Process Clustering Documents • Conclusion follows necessary from the premises. Motivation k-Means Clustering • From A ⇒ B and A, we conclude that B Application Example Classiﬁcations & • We conclude from the general case to a speciﬁc example of the general case Predictions Introduction • Example: Classiﬁcation with kNN Regression with kNN 1 All men are mortal. Machine Learning 2 Socrates is a man. Evaluation Evaluation Methodology 3 from 1 ∧ 2 ⇒ Socrates is mortal. Evaluation Metrics Error Analysis • Our subclass inference in RDFS also falls into this category. Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading 7.6 BreakPage Abduction René Witte Machine Learning Primer History Abductive Reasoning ML Types Process • Conclusion is one hypothetical (most probable) explanation for the premises Clustering Documents Motivation • From A ⇒ B and B, we conclude A k-Means Clustering Application Example • Example: Classiﬁcations & Predictions 1 Drunk people do not walk straight. Introduction 2 John does not walk straight. Classiﬁcation with kNN Regression with kNN 3 from 1 ∧ 2 ⇒ John is drunk. Machine Learning Evaluation • Not sound. . . but may be most likely explanation for B Evaluation Methodology Evaluation Metrics • Used in medicine. . . Error Analysis Overﬁtting 1 in reality: disease ⇒ symptoms Underﬁtting 2 patient complains about some symptoms. . . doctor concludes a disease Cross-Validation Notes and Further Reading 7.7 BreakPage Induction René Witte Machine Learning Primer History Inductive Reasoning ML Types Process • Conclusion about all members of a class from the examination of only a few Clustering Documents member of the class. Motivation k-Means Clustering Application Example • From A∧C ⇒ B and A∧D ⇒ B, we conclude A⇒B Classiﬁcations & Predictions • We construct a general explanation based on speciﬁc cases Introduction • Example: Classiﬁcation with kNN Regression with kNN 1 All CS students in COMP 474 are smart. Machine Learning Evaluation 2 All CS students on vacation are smart. Evaluation Methodology 3 from 1 ∧ 2 ⇒ All CS students are smart. Evaluation Metrics Error Analysis • Not sound Overﬁtting Underﬁtting • But, can be seen as hypothesis construction or generalisation Cross-Validation Notes and Further Reading 7.8 BreakPage Inductive Learning René Witte Learning from examples • Most work in ML Machine Learning Primer • Examples are given (positive and/or negative) to train a system in a History classiﬁcation (or regression) task ML Types Process • Extrapolate from the training set to make accurate predictions about future Clustering Documents Motivation examples k-Means Clustering Application Example • Given a new instance X you have never seen, you must ﬁnd an estimate of the Classiﬁcations & function f(X) where f(X) is the desired output Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading Fromdatascience.com,https://towardsdatascience.com/cat-dog-or-elon-musk-145658489730 7.9 BreakPage Example René Witte • Given pairs (X , f (X )) (the training set – the data points) • Find a function f that ﬁts the training set well Machine Learning Primer • So that given a new X , you can predict its f (X ) value History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading Note: choosing one function over another beyond just looking at the training set is called inductive bias (eg. prefer “smoother” functions) 7.10 BreakPage Inductive Learning Framework René Witte Machine Learning Primer History ML Types Process Feature Vectors Clustering Documents Motivation • Input data are represented by a vector of features, X k-Means Clustering Application Example • Each vector X is a list of (attribute, value) pairs. Classiﬁcations & Predictions • Ex: X =[nose:big, teeth:big, eyes:big, moustache:no] Introduction Classiﬁcation with kNN • The number of attributes is ﬁxed (positive, ﬁnite) Regression with kNN • Each attribute has a ﬁxed, ﬁnite number of possible values Machine Learning Evaluation Evaluation Methodology • Each example can be interpreted as a point in a n-dimensional feature space, Evaluation Metrics where n is the number of attributes (features) Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading 7.11 BreakPage Some Machine Learning Techniques René Witte Machine Learning Primer History Probabilistic Methods ML Types Process • e.g., Naïve Bayes Classiﬁer Clustering Documents Motivation k-Means Clustering Application Example Decision Trees Classiﬁcations & Predictions • Use only discriminating features as questions in a big if-then-else tree Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Neural Networks Evaluation Evaluation Methodology • Also called parallel distributed processing or connectionist systems Evaluation Metrics Error Analysis • Intelligence arise from having a large number of simple computational units Overﬁtting Underﬁtting Cross-Validation NB: Deep Learning ≈ Neural Networks “on steroids” Notes and Further Reading 7.12 BreakPage Supervised Learning René Witte Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Labeled Data Notes and Further In Supervised Learning, we train a system using data with known labels. Reading 7.13 BreakPage Unsupervised Learning René Witte Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Unlabeled Data Cross-Validation In Unsupervised Learning, we have only unlabeled data and train a system without Notes and Further Reading guidance from an expected output. 7.14 BreakPage Reinforcement Learning René Witte Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading 7.15 BreakPage AI Learns to Park René Witte Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading https://www.youtube.com/watch?v=VMp6pq6_QjI 7.16 BreakPage Machine Learning Categories René Witte Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading 7.17 BreakPage René Witte Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading http://www.cognub.com/index.php/cognitive-platform/ 7.18 BreakPage General machine learning process René Witte Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading → Worksheet #6: Task 1 7.19 BreakPage Outline René Witte Machine Learning Primer 1 Machine Learning Primer History ML Types Process 2 Clustering Documents Clustering Documents Motivation Motivation k-Means Clustering k-Means Clustering Application Example Classiﬁcations & Application Example Predictions Introduction Classiﬁcation with kNN Regression with kNN 3 Classiﬁcations & Predictions Machine Learning Evaluation Evaluation Methodology 4 Machine Learning Evaluation Evaluation Metrics Error Analysis Overﬁtting Underﬁtting 5 Notes and Further Reading Cross-Validation Notes and Further Reading 7.20 BreakPage Math with Words René Witte Vector Space Model • A mathematical model to portray an n-dimensional space Machine Learning Primer • Entities are described by vectors with n coordinates in a real space Rn History ML Types Process • Given two vectors, we can compute a similarity coefﬁcient between them Clustering Documents Motivation • Cosine of the angle between two vectors reﬂects their degree of similarity k-Means Clustering Application Example Classiﬁcations & Predictions Introduction tf = 1 + log(tft,d) (1) Classiﬁcation with kNN Regression with kNN N Machine Learning idf = log (2) Evaluation dft Evaluation Methodology Evaluation Metrics cos((cid:126)q , (cid:126)d ) = (cid:113) (cid:80)|i=v|1 q(cid:113)i · di (3) EOrvreorrﬁAttninaglysis (cid:80)|i=v|1 qi2 · (cid:80)i|=v|1 di2 UCnrodsesr-ﬁVttainlidgation Notes and Further Reading 7.21 BreakPage Motivation René Witte Machine Learning Primer History Intelligent Systems for Investigative Journalism ML Types Process Organize large, unstructured document collections: Clustering Documents Motivation • Enron email dataset – ca. 500,000 emails from management k-Means Clustering Application Example • Wikileaks – often releases millions of documents Classiﬁcations & • Guantanamo Bay Files, TPP Agreements, CIA Documents, German BND-NSA Predictions Introduction Inquiry, . . . Classiﬁcation with kNN Regression with kNN • Facebook internal documents leaks (Cambridge Analytica scandal, 7000 Machine Learning documents) Evaluation Evaluation Methodology • Luanda Leaks (715,000 emails, charts, contracts, audits, etc.) Evaluation Metrics Error Analysis • Paradise Papers (13.4 million conﬁdential papers regarding offshore Overﬁtting Underﬁtting investments) Cross-Validation Notes and Further Reading 7.22 BreakPage René Witte Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading https://www.thestar.com/news/paradise-papers/2019/01/29/ canada-revenue-agency-launches-100-audits-after-paradise-papers-leak.html 7.23 BreakPage René Witte Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading https://opensemanticsearch.org 7.24 BreakPage Clustering René Witte Unsupervised Learning • Remember, we do not “classify” documents (like in “spam vs. ham”) Machine Learning Primer • Rather, we group similar documents together History ML Types • Often used as a ﬁrst exploratory step in data analysis Process Clustering Documents • Data points (here: documents) in individual clusters can be further analyzed, Motivation possibly with different methods k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading 7.25 BreakPage What are Clusters? René Witte Clustering Machine Learning • The organization of unlabeled data into similarity groups, called clusters Primer History • A cluster is a collection of data items which are “similar” between them, and ML Types Process “dissimilar” to data items in other clusters. Clustering Documents • Generally, there is no right or wrong answer to what the clusters in a dataset Motivation k-Means Clustering are. Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading 7.26 BreakPage Clustering Techniques René Witte Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading 7.27 BreakPage k-Means Clustering René Witte Machine Learning Partition-based Clustering Primer History K-means (MacQueen, 1967) is a partitional clustering algorithm: ML Types Process • Given m vectors in an n-dimensional space, (cid:126)x1, . . . , x(cid:126)m ∈ Rn Clustering Documents Motivation • User deﬁnes k , the number of clusters k-Means Clustering Application Example Classiﬁcations & Algorithm Predictions Introduction Classiﬁcation with kNN 1 Pick k points from the dataset (usually at random). Regression with kNN These points represent our initial group centroïds. Machine Learning Evaluation 2 Assign each data point (cid:126)xi to the nearest centroïd. EEvvaalluuaattiioonn MMeetthriocsdology 3 When all data points have been assigned, recalculate the positions of the k EOrvreorrﬁAttninaglysis centroïds as the average of the cluster. Underﬁtting Cross-Validation 4 Repeat Steps 2 and 3 until none of the data instances change group Notes and Further Reading (or changes stay below a given convergence limit ∆). 7.28 BreakPage Euclidian Distance René Witte Machine Learning To ﬁnd the nearest centroïd: Primer History • a possible metric is the ML Types Process Euclidean distance Clustering Documents Motivation • distance d between 2 points p, q k-Means Clustering Application Example Classiﬁcations & p = (p1, p2, . . . , pn) Predictions Introduction q = (q1, q2, . . . , qn) Classiﬁcation with kNN Regression with kNN (cid:118) (cid:117) n Machine Learning (cid:117)(cid:88) Evaluation d = (cid:116) (pi − qi )2 Evaluation Methodology Evaluation Metrics i=1 Error Analysis Overﬁtting • where to assign a data point (cid:126)x? Underﬁtting Cross-Validation • → for all k clusters, choose the one Notes and Further Reading where (cid:126)x has the smallest distance 7.29 BreakPage Example (1/5) René Witte 2D-vectors, k=3: Initialize random centroïds Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading 7.30 BreakPage Example (2/5) René Witte Partition data points to closest centroïds Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading 7.31 BreakPage Example (3/5) René Witte Compute new centroïds Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading 7.32 BreakPage Example (4/5) René Witte Re-assign data points to closest new centroïds Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading 7.33 BreakPage Example (5/5) René Witte Repeat until clusters stabilize Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading 7.34 BreakPage k-Means Clustering Illustrated René Witte Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading https://www.youtube.com/watch?v=5I3Ei69I40s → Worksheet #6: Task 2 7.35 BreakPage k-Means: Pros & Cons René Witte Machine Learning Pros Primer History • Simple, easy to understand and implement ML Types Process • Converges very fast Clustering Documents Motivation • Efﬁcient: Time complexity O(t · k · n), with k-Means Clustering Application Example • n number of data points Classiﬁcations & • k number of clusters Predictions Introduction • t number of iterations Classiﬁcation with kNN Regression with kNN → considered linear for practical purposes Machine Learning Evaluation Evaluation Methodology Cons Evaluation Metrics Error Analysis Overﬁtting • User needs to choose k (usually not known) Underﬁtting Cross-Validation • Sensitive to outliers Notes and Further Reading • Different results on same dataset, based on initial (random) centroïds 7.36 BreakPage k-Means & Outliers René Witte Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading 7.37 BreakPage k-Means: Sensitivity to Initial Seeds René Witte Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading 7.38 BreakPage k-Means René Witte Summary Machine Learning • Despite weaknesses, k-means is still one of the most popular algorithms, due Primer History to its simplicity and efﬁciency ML Types Process • No clear evidence that any other clustering algorithm performs better in general Clustering Documents Motivation • Comparing different clustering algorithms is a difﬁcult task: k-Means Clustering No one knows the correct clusters! Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading 7.39 BreakPage Document Clustering Example: Analyzing NSF Research Grants René Witte Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading https://www.youtube.com/watch?v=85fZcK5EpnA 7.40 BreakPage Outline René Witte Machine Learning Primer 1 Machine Learning Primer History ML Types Process 2 Clustering Documents Clustering Documents Motivation k-Means Clustering Application Example 3 Classiﬁcations & Predictions Classiﬁcations & Introduction Predictions Introduction Classiﬁcation with kNN Classiﬁcation with kNN Regression with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology 4 Machine Learning Evaluation Evaluation Metrics Error Analysis Overﬁtting Underﬁtting 5 Notes and Further Reading Cross-Validation Notes and Further Reading 7.41 BreakPage Classiﬁcation of Data René Witte Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading 7.42 BreakPage Classiﬁcation Algorithms René Witte Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading 7.43 BreakPage k-Nearest-Neighbor (kNN) Classiﬁcation René Witte kNN Algorithm Machine Learning Training: only store feature vectors + class labels Primer History Testing: Find the k data points nearest (e.g., Euclidian distance) to the new ML Types Process value. Resulting class is decided by majority vote. Clustering Documents Note: in this simple form, kNN has no training effort, but large testing effort Motivation k-Means Clustering (so-called lazy learning) Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading CopyrightAnttiAjanki(https://commons.wikimedia.org/wiki/File:KnnClassiﬁcation.svg),“KnnClassiﬁcation”, licensedunderhttps://creativecommons.org/licenses/by-sa/3.0/legalcode 7.44 BreakPage kNN Classiﬁcation René Witte With k = 1 • Compute the distance of the unknown sample to all existing samples Machine Learning • Assign the class of the closest neighbor to the new sample Primer History • Distance can be computed with different metrics, e.g., ML Types Process Euclidean distance or Manhattan distance Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading Copyright2017byO’ReillyMedia,Inc.,[MG17] 7.45 BreakPage kNN Classiﬁcation: General case René Witte With arbitrary k • kNN classiﬁcation becomes a voting algorithm Machine Learning Primer • assign the same class as the majority of the k closest neighbors to the new History sample ML Types Process • Choice of k is dependent on data set Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading Copyright2017byO’ReillyMedia,Inc.,[MG17] 7.46 BreakPage Netﬂix: Predict Success of Original Content René Witte In 2013, Netﬂix decided to commission two seasons of the U.S. remake of the British series House of Cards based on an analysis of its customers’ data Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading https://informationstrategyrsm.wordpress.com/2014/10/19/ big-data-analytics-house-of-cards-and-future-of-television-creation-consumption/ → Worksheet #6: Task 3 7.47 BreakPage Regression René Witte Forecasting or predicting a value: e.g., house price, movie rating, temperature at noon, ... Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading http://www.cognub.com/index.php/cognitive-platform/ 7.48 BreakPage kNN Regression René Witte With k = 1 • Find the nearest existing data point to a new sample as before Machine Learning • Assign the value of this point (e.g., price, rating, ...) to the new instance Primer History • Note: given n-dimensional vectors, we are using n − 1 dimensions for the similarity ML Types Process and the ﬁnal for the predicted value Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading Copyright2017byO’ReillyMedia,Inc.,[MG17] 7.49 BreakPage kNN Regression: General Case René Witte Find the k nearest existing data points Assign the average of their values to the new point Machine Learning • Note that this algorithm cannot extrapolate Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading Copyright2017byO’ReillyMedia,Inc.,[MG17] → Worksheet #6: Task 4 7.50 BreakPage Machine Learning at Netﬂix René Witte Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading https://www.youtube.com/watch?v=X9ZES-fsxgU 7.51 BreakPage Outline René Witte 1 Machine Learning Primer Machine Learning Primer History ML Types 2 Clustering Documents Process Clustering Documents Motivation 3 Classiﬁcations & Predictions k-Means Clustering Application Example Classiﬁcations & Predictions 4 Machine Learning Evaluation Introduction Classiﬁcation with kNN Evaluation Methodology Regression with kNN Evaluation Metrics Machine Learning Evaluation Error Analysis Evaluation Methodology Overﬁtting Evaluation Metrics Error Analysis Underﬁtting Overﬁtting Underﬁtting Cross-Validation Cross-Validation Notes and Further Reading 5 Notes and Further Reading 7.52 BreakPage Evaluation of a ML Model René Witte Machine Learning Primer History Methodology ML Types Process • How do you know if what you learned is correct? Clustering Documents Motivation • You run your classiﬁer on a data set of unseen examples (that you did not use k-Means Clustering Application Example for training) for which you know the correct classiﬁcation (“gold standard”) Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Training vs. testing data Regression with kNN Machine Learning • Split data into training (80%) and testing (20%) sets Evaluation Evaluation Methodology • Depending on ML algorithm, the training set can be further split into: Evaluation Metrics Error Analysis • Actual training set (80%) Overﬁtting Underﬁtting • Validation set (20%) Cross-Validation Notes and Further Reading 7.53 BreakPage Standard Methodology René Witte 1 Collect a large set of examples (all with correct classiﬁcations) 2 Divide collection into training, validation and test set Machine Learning 3 Apply learning algorithm to training set to learn the parameters Primer History 4 Measure performance with the validation set, and adjust hyper-parameters to MPrLocTeyspses improve performance Clustering Documents Motivation 5 Performance not good enough? ⇒ 3 k-Means Clustering Application Example 6 Measure performance with the test set Classiﬁcations & Predictions Introduction DO NOT LOOK AT THE TEST SET Classiﬁcation with kNN Regression with kNN until you arrived at Step 6. Machine Learning Evaluation Evaluation Methodology Hyper-Parameters Evaluation Metrics Parameters Error Analysis Basic values learned by the ML Parameters used to set up the ML Overﬁtting model, e.g.: Underﬁtting model, e.g.: Cross-Validation • for NB: value of delta for Notes and Further • for NB: prior & conditional Reading smoothing probabilities • for DTs: pruning level • for DTs: features to split • for ANNs: # of hidden layers, # of • for ANNs: weights nodes per layer. . . 7.54 BreakPage Metrics René Witte Machine Learning Primer History ML Types Accuracy Process Clustering Documents • % of instances of the test set the algorithm correctly classiﬁes Motivation k-Means Clustering • when all classes are equally important and represented Application Example Classiﬁcations & Predictions Introduction Recall & Precision Classiﬁcation with kNN Regression with kNN • when one class is more important than the others Machine Learning Evaluation Evaluation Methodology Evaluation Metrics F-Measure Error Analysis Overﬁtting • Combined Precision & Recall (harmonic mean) Underﬁtting Cross-Validation Notes and Further Reading 7.55 BreakPage ML Evaluation René Witte Evaluation of Classiﬁers Machine Learning What kind of errors can we make? Primer History ML Types Reality says. . . Process Positive Negative Clustering Documents Motivation Positive True Positive (TP) False Positive (FP) k-Means Clustering Model predicts. . . Negative False Negative (FN) True Negative (TN) Application Example Classiﬁcations & Predictions This is a so-called (binary) confusion matrix Introduction Classiﬁcation with kNN Regression with kNN Error Types Machine Learning Evaluation • False positive classiﬁcation: Type I error Evaluation Methodology Evaluation Metrics (“convict the innocent!”) Error Analysis Overﬁtting • False negative classiﬁcation: Type II error Underﬁtting Cross-Validation (“free the guilty!”) Notes and Further Reading Important realization: not all errors are created equal! Voltaire: “It is better to risk saving a guilty man than to condemn an innocent one.” 7.56 BreakPage Evaluation Metrics René Witte Commonly used Machine Learning Primer • Accuracy = (TP + TN)/(TP + TN + FP + FN) History ML Types • Recall = TP/(TP + FN) Process Clustering Documents • Precision = TP/(TP + FP) Motivation k-Means Clustering • F -score = 2·Precision·Recall (harmonic mean) Application Example 1 Precision+Recall Classiﬁcations & Predictions Introduction Mind the evaluation task Classiﬁcation with kNN Regression with kNN Precision, recall etc. are deﬁned slightly differently Machine Learning for: Evaluation Evaluation Methodology • Information retrieval tasks Evaluation Metrics Error Analysis • Classiﬁcation tasks Overﬁtting Underﬁtting Cross-Validation • Ranked retrieval tasks Notes and Further • Information extraction tasks Reading → Worksheet #6: Task 5 CopyrightbyWalber(https://commons.wikimedia.org/wiki/File:Precisionrecall.svg),licensedundertheCreative Chtotpmsm://ocnresaAtivttericboumtiomno-Snsh.aorreg/Aliclikeens4e.0s/bInyt-esran/a4t.io0n/leagllaiclceondsee 7.57 → Worksheet #6: Task 5 BreakPage Confusion Matrix René Witte • Where did the learner go wrong ? Machine Learning • Use a confusion matrix (contingency table) Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading 7.58 BreakPage Learning Curve René Witte Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Copyright2007–2019,scikit-learndevelopers(BSDLicense),https://scikit-learn.org/stable/auto_examples/model_selection/plot_learning_curve.html Cross-Validation Notes and Further Reading Plot evaluation metric vs. size of training set • the more, the better • but after a while, not much improvement. . . 7.59 BreakPage Some Words on Training. . . René Witte Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Watch out for: Application Example Classiﬁcations & • Noisy Data Predictions Introduction • Overﬁtting/Underﬁtting Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading 7.60 BreakPage Noisy Data René Witte Machine Learning Primer History Common issues ML Types Process • Two examples have the same feature-value pairs, but different outputs Clustering Documents Motivation • Some values of features are incorrect or missing (ex. errors in the data k-Means Clustering Application Example acquisition) Classiﬁcations & Predictions • Some relevant attributes are not taken into account in the data set Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading 7.61 BreakPage Overﬁtting René Witte Machine Learning Primer • If a large number of irrelevant History features are there, we may ﬁnd ML Types Process meaningless regularities in the data Clustering Documents that are particular to the training data Motivation k-Means Clustering but irrelevant to the problem. Application Example Classiﬁcations & • Complicated boundaries overﬁt the Predictions data (a.k.a. overtraining) Introduction Classiﬁcation with kNN Regression with kNN • they are too tuned to the particular Machine Learning training data at hand Evaluation Evaluation Methodology • They do not generalize well to the Evaluation Metrics Error Analysis new data Overﬁtting Underﬁtting • Extreme case: “rote learning” Cross-Validation • Training error is low NRoetaedsinagnd Further • Testing error is high CopyrightbyChabacano(https://commons.wikimedia.org/wiki/File:Overﬁtting.svg)licenseundertheCreativeCommonsAttribution-Share Alike4.0Internationallicense,https://creativecommons.org/licenses/by-sa/4.0/legalcode 7.62 BreakPage Underﬁtting René Witte Machine Learning Primer History ML Types Process • We can also underﬁt data, i.e. use Clustering Documents too simple decision boundary Motivation k-Means Clustering • Model is not expressive enough (not Application Example Classiﬁcations & enough features) Predictions Introduction • a.k.a. Undertraining Classiﬁcation with kNN Regression with kNN • There is no way to ﬁt a linear Machine Learning decision boundary so that the Evaluation Evaluation Methodology training examples are well separated Evaluation Metrics Error Analysis • Training error is high Overﬁtting • Testing error is high Underﬁtting Cross-Validation Notes and Further Reading 7.63 BreakPage Example: Animal Classiﬁcation René Witte Features What about cat vs. dog? Machine Learning Primer History ML Types Process Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & Predictions Introduction Classiﬁcation with kNN Regression with kNN Machine Learning Evaluation Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading [from: Alison Cawsey: The Essence of AI (1997)] 7.64 BreakPage Cross-Validation René Witte Data Scarcity Machine Learning • there is never enough training data Primer History • so testing data is precious as well ML Types Process Clustering Documents Motivation k-fold Cross-Validation k-Means Clustering Application Example ‘Re-use’ different parts of the training data for testing. E.g., 10-fold cross-validation: Classiﬁcations & Predictions • split data into 10 equal parts Introduction Classiﬁcation with kNN • train on 9 of these, test on the 10th Regression with kNN • repeat 10 times, resulting in 10 different performance results Machine Learning Evaluation Evaluation Methodology • average these for overall performance Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading 7.65 BreakPage Outline René Witte Machine Learning Primer History 1 Machine Learning Primer ML Types Process Clustering Documents 2 Clustering Documents Motivation k-Means Clustering Application Example Classiﬁcations & 3 Classiﬁcations & Predictions Predictions Introduction Classiﬁcation with kNN Regression with kNN 4 Machine Learning Evaluation Machine Learning Evaluation Evaluation Methodology 5 Notes and Further Reading Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading 7.66 BreakPage Reading Material René Witte Machine Learning Primer History ML Types Process Clustering Documents Required Motivation k-Means Clustering • [MG17, Chapters 2, 3, 5] (kNN, k-Means, Evaluation) Application Example Classiﬁcations & Predictions Introduction Supplemental Classiﬁcation with kNN Regression with kNN • [PS12, Chapter 7] (ML Training) Machine Learning Evaluation • [PS12, Chapter 8] (Testing and Evaluation) Evaluation Methodology Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading 7.67 BreakPage References René Witte Machine Learning Primer History ML Types Process [MG17] Andreas C Müller and Sarah Guido. Clustering Documents Motivation Introduction to Machine Learning with Python. k-Means Clustering Application Example O’Reilly, 2017. Classiﬁcations & https://concordiauniversity.on.worldcat.org/oclc/960211579. Predictions Introduction Classiﬁcation with kNN [PS12] James Pustejovsky and Amber Stubbs. Regression with kNN Natural Language Annotation for Machine Learning. Machine Learning Evaluation O’Reilly, 2012. Evaluation Methodology https://concordiauniversity.on.worldcat.org/oclc/801812987. Evaluation Metrics Error Analysis Overﬁtting Underﬁtting Cross-Validation Notes and Further Reading 7.68 BreakPage 