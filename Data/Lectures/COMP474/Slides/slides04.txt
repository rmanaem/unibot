René Witte Lecture 4 Introduction Knowledge Base Queries & SPARQL Review OWL Queries SPARQL Queries COMP 474/6741, Winter 2022 Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading René Witte Department of Computer Science and Software Engineering Concordia University 4.1 BreakPage Outline René Witte Introduction Review OWL Queries 1 Introduction SPARQL Queries Introduction Describe 2 SPARQL Queries Select Construct Ask Other SPARQL Features 3 SPARQL Protocol SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing 4 Notes and Further Reading Notes and Further Reading 4.2 BreakPage René Witte Introduction Review OWL Queries SPARQL Queries Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading Slides Credit • Includes slides by Ivan Herman, W3C [Her] 4.3 BreakPage Outline René Witte Introduction Review OWL 1 Introduction Queries Review SPARQL Queries OWL Introduction Describe Queries Select Construct Ask Other SPARQL Features 2 SPARQL Queries SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing 3 SPARQL Protocol Notes and Further Reading 4 Notes and Further Reading 4.4 BreakPage René Witte Introduction Review OWL Queries SPARQL Queries Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading Photo credit “Indy Reading Coalition”, Wordpress.com  4.5 BreakPage René Witte Introduction Review OWL Data integration needs agreements on }  Queries SPARQL Queries §  terms  Introduction Describe •  “translator”, “author” Select Construct §  categories used  Ask Other SPARQL Features •  “Person”, “literature” SPARQL Protocol Named Graphs §  relationships among those  Serving Knowledge Graphs Inferencing •  “an author is also a Person…”, “historical ﬁction is a narrower  Notes and Further Reading term than ﬁction” •  ie, new relationships can be deduced (223)  223  4.6 BreakPage René Witte Introduction Review OWL There is a need for “languages” to deﬁne such  }  Queries SPARQL Queries vocabularies Introduction Describe §  to deﬁne those vocabularies Select Construct §  to assign clear “semantics” on how new relationships can be  Ask Other SPARQL Features deduced SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading (224)  224  4.7 BreakPage René Witte Introduction Review OWL Think of well known traditional vocabularies: }  Queries SPARQL Queries §  use the term “novel” Introduction Describe §  “every novel is a ﬁction” Select Construct §  “«The Glass Palace» is a novel” Ask Other SPARQL Features §  etc. SPARQL Protocol Named Graphs Serving Knowledge Graphs }  RDFS deﬁnes resources and classes: Inferencing Notes and Further §  everything in RDF is a “resource” Reading §  “classes” are also resources, but… §  …they are also a collection of possible resources (i.e.,  “individuals”) •  “ﬁction”, “novel”, … (69)  69  4.8 BreakPage René Witte Introduction Review OWL Relationships are deﬁned among resources: }  Queries SPARQL Queries §  “typing”: an individual belongs to a speciﬁc class  Introduction Describe •  “«The Glass Palace» is a novel” Select Construct •  to be more precise: “«http://.../000651409X» is a novel” Ask Other SPARQL Features §  “subclassing”: all instances of one are also the instances of  SPARQL Protocol Named Graphs the other (“every novel is a ﬁction”) Serving Knowledge Graphs Inferencing }  RDFS formalizes these notions in RDF Notes and Further Reading (70)  70  4.9 BreakPage René Witte Introduction Review OWL rdfs:Class  Queries SPARQL Queries Introduction Describe Select Construct Ask http://…isbn/ rdf:type  Other SPARQL Features 000651409X  #Novel  SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading RDFS deﬁnes the meaning of these terms }  §  (these are all special URI-s, we just use the namespace  abbreviation) → Worksheet #3: Tasks 1 & 2 (71)  71  4.10 BreakPage Reuse vocabularies whenever possible René Witte Introduction Review OWL Queries SPARQL Queries Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading Copyright2014byManningPublicationsCo.,[WZRH14] 4.11 BreakPage Core Vocabularies René Witte Introduction Review OWL Queries SPARQL Queries Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading Copyright2014byManningPublicationsCo.,[WZRH14] 4.12 BreakPage More authoritative vocabularies René Witte Introduction Review OWL Queries SPARQL Queries Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading Copyright2014byManningPublicationsCo.,[WZRH14] 4.13 BreakPage Outline René Witte Introduction Review OWL 1 Introduction Queries Review SPARQL Queries OWL Introduction Describe Queries Select Construct Ask Other SPARQL Features 2 SPARQL Queries SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing 3 SPARQL Protocol Notes and Further Reading 4 Notes and Further Reading 4.14 BreakPage OWL René Witte Introduction Review OWL The Web Ontology Language (OWL) Queries SPARQL Queries • Current version OWL2 (2009) Introduction Describe • Different OWL2-Proﬁles (lite, full, Select Construct etc.) Ask Other SPARQL Features • Ontology language based on SPARQL Protocol Named Graphs Description Logics (DL) Serving Knowledge Graphs Inferencing • Enables logic-based reasoning Notes and Further Reading http://www.w3.org/TR/owl2-overview/ 4.15 BreakPage René Witte Introduction Review OWL OWL Full  Queries SPARQL Queries Introduction Describe OWL DL  Select Construct Ask Other SPARQL Features OWL EL  OWL RL  SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading OWL QL  (282)  282  4.16 BreakPage René Witte Introduction Review OWL For individuals: }  Queries SPARQL Queries §  owl:sameAs: two URIs refer to the same concept  Introduction Describe (“individual”) Select Construct §  owl:differentFrom: negation of owl:sameAs Ask Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading (245)  245  4.17 BreakPage René Witte Introduction Review OWL Queries SPARQL Queries owl:equivalentProperty  Introduction a:author  f:auteur  Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading owl:equivalentClass  a:Novel  f:Roman  (246)  246  4.18 BreakPage René Witte Introduction Review }  Linking our example of Amsterdam from one data  OWL Queries set (DBpedia) to the other (Geonames): SPARQL Queries Introduction Describe Select Construct Ask <http://dbpedia.org/resource/Amsterdam>  Other SPARQL Features   owl:sameAs <http://sws.geonames.org/2759793>;  SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading }  This is the main mechanism of “Linking” in the  Linked Open Data project → Worksheet #3: Task 3 (247)  247  4.19 BreakPage René Witte Introduction Review OWL In OWL, one can characterize the behavior of  }  Queries SPARQL Queries properties (symmetric, transitive, functional, inverse  Introduction Describe functional, reﬂexive, irreﬂexive, …) Select Construct Ask }  OWL also separates data and object properties Other SPARQL Features SPARQL Protocol §  “datatype property” means that its range are typed literals Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading (248)  248  4.20 BreakPage René Witte Introduction Review OWL “foaf:email” may be deﬁned as “inverse functional” }  Queries SPARQL Queries §   i.e., two different subjects cannot have identical objects Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading (249)  249  4.21 BreakPage René Witte Introduction Review }  If the following holds in our triples: OWL Queries :email rdf:type owl:InverseFunctionalProperty.   SPARQL Queries Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading (250)  250  4.22 BreakPage René Witte Introduction Review }  If the following holds in our triples: OWL Queries :email rdf:type owl:InverseFunctionalProperty.   SPARQL Queries Introduction <A> :email "mailto:a@b.c".  Describe <B> :email "mailto:a@b.c".  Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading (251)  251  4.23 BreakPage René Witte Introduction Review }  If the following holds in our triples: OWL Queries :email rdf:type owl:InverseFunctionalProperty.   SPARQL Queries Introduction <A> :email "mailto:a@b.c".  Describe <B> :email "mailto:a@b.c".  Select Construct Ask then, processed through OWL, the following holds,  Other SPARQL Features SPARQL Protocol too: Named Graphs Serving Knowledge Graphs Inferencing Notes and Further <A> owl:sameAs <B>.  Reading (252)  252  4.24 BreakPage René Witte Introduction Review OWL There may be an inverse relationship among  }  Queries SPARQL Queries properties, eg: Introduction Describe Select Construct Ask <somebook> ex:author <somebody>.   Other SPARQL Features ex:author owl:inverseOf ex:authorOf.  SPARQL Protocol Named Graphs Serving Knowledge Graphs yields, in OWL: Inferencing Notes and Further Reading <somebody> ex:authorOf <somebook>.  (253)  253  4.25 BreakPage René Witte Introduction Review OWL In RDFS, you can subclass existing classes… that’s  }  Queries SPARQL Queries all Introduction Describe In OWL, you can construct classes from existing  Select }  Construct Ask ones: Other SPARQL Features SPARQL Protocol §  enumerate its content Named Graphs Serving Knowledge Graphs §  through intersection, union, complement Inferencing Notes and Further §  etc Reading (259)  259  4.26 BreakPage René Witte Introduction Review OWL OWL DL can be interpreted as a variant of  }  Queries SPARQL Queries Description Logic Introduction Describe §  for connoisseurs: OWL (2) DL ≈ SROIQ (D) Select Construct Ask }  Hence the results of this  particular area of logic are  Other SPARQL Features SPARQL Protocol directly applicable Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading (290)  290  4.27 BreakPage René Witte Introduction Review OWL There is also a compact mathematical notation for  }  Queries SPARQL Queries axioms, assertions, etc: Introduction Describe §  Literature ≣ Novel ⊔ Short_Story ⊔ Poetry Select Construct §  Listed_Price ⊑ ∀currency.Currencies Ask Other SPARQL Features SPARQL Protocol You may see these in papers, books… }  Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading (292)  292  4.28 BreakPage René Witte Introduction Review OWL eClassOwl: eBusiness ontology for products and  }  Queries SPARQL Queries services, 75,000 classes and 5,500 properties Introduction Describe National Cancer Institute’s ontology: about 58,000  Select }  Construct Ask classes Other SPARQL Features SPARQL Protocol Open Biomedical Ontologies Foundry: a collection  Named Graphs }  Serving Knowledge Graphs Inferencing of ontologies, including the Gene Ontology to  Notes and Further Reading describe gene and gene product attributes in any  organism or  protein sequence and annotation  terminology and data (UniProt) BioPAX: for biological pathway data }  (307)  307  4.29 BreakPage Outline René Witte Introduction Review OWL 1 Introduction Queries Review SPARQL Queries OWL Introduction Describe Queries Select Construct Ask Other SPARQL Features 2 SPARQL Queries SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing 3 SPARQL Protocol Notes and Further Reading 4 Notes and Further Reading 4.30 BreakPage René Witte Introduction Review OWL Remember the Python+RDFLib idiom: }  Queries SPARQL Queries Introduction Describe Select for (s,p,o) in graph.triples((subject,None,None)) :  Construct   do_something(p,o);  Ask Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading (196)  196  4.31 BreakPage René Witte Introduction Review OWL In practice, more complex queries into the RDF data  }  Queries SPARQL Queries are necessary Introduction Describe §  something like: “give me the (a,b) pair of resources, for  Select Construct which there is an x such that (x parent a) and (b brother x)  Ask Other SPARQL Features holds” (ie, return the uncles) SPARQL Protocol Named Graphs •  these rules may become quite complex Serving Knowledge Graphs Inferencing }  The goal of SPARQL (Query Language for RDF) Notes and Further Reading (197)  197  4.32 BreakPage René Witte Introduction Review OWL for (s,p,o) in graph.triples((subject,None,None)) :  Queries   do_something(p,o);  SPARQL Queries Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs ?p  Inferencing ?o  Notes and Further Reading ?p  ?o  subject  ?p  ?o  ?p  ?o  (198)  198  4.33 BreakPage René Witte Introduction Review OWL The fundamental idea: use graph patterns }  Queries SPARQL Queries §  the pattern contains unbound symbols Introduction Describe §  by binding the symbols, subgraphs of the RDF graph are  Select Construct selected Ask Other SPARQL Features §  if there is such a selection, the query returns the bound  SPARQL Protocol Named Graphs resources Serving Knowledge Graphs Inferencing Notes and Further Reading (199)  199  4.34 BreakPage René Witte Introduction SELECT ?p ?o  Review WHERE {subject ?p ?o}  OWL Queries The triples in WHERE deﬁne the graph pattern,  SPARQL Queries }  Introduction Describe with ?p and ?o “unbound” symbols Select Construct The query returns all p,o pairs Ask }  Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs ?p  Inferencing ?o  Notes and Further Reading ?p  ?o  subject  ?p  ?o  ?p  ?o  (200)  200  4.35 BreakPage René Witte Introduction SELECT ?isbn ?price ?currency # note: not ?x!  Review WHERE {?isbn a:price ?x. ?x rdf:value ?price. ?x p:currency ?currency.}  OWL Queries SPARQL Queries Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs a:name  Ghosh, Amitav  Serving Knowledge Graphs Inferencing Notes and Further a:author  a:author  Reading http://…isbn/000651409X  http://…isbn/2020386682  a:price  a:price  a:price  a:price  rdf:value  p:currency  rdf:value  p:currency  rdf:value  p:currency  rdf:value  p:currency  33  :£  50  :€  60  :€  78  :$  (201)  201  4.36 BreakPage René Witte Introduction SELECT ?isbn ?price ?currency # note: not ?x!  Review WHERE {?isbn a:price ?x. ?x rdf:value ?price. ?x p:currency ?currency.}  OWL Queries SPARQL Queries Returns: [<…409X>,33,:£] Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs a:name  Ghosh, Amitav  Serving Knowledge Graphs Inferencing Notes and Further a:author  a:author  Reading http://…isbn/000651409X  http://…isbn/2020386682  a:price  a:price  a:price  a:price  rdf:value  p:currency  rdf:value  p:currency  rdf:value  p:currency  rdf:value  p:currency  33  :£  50  :€  60  :€  78  :$  (202)  202  4.37 BreakPage René Witte Introduction SELECT ?isbn ?price ?currency # note: not ?x!  Review WHERE {?isbn a:price ?x. ?x rdf:value ?price. ?x p:currency ?currency.}  OWL Queries SPARQL Queries Returns: [<…409X>,33,:£],  [<…409X>,50,:€] Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs a:name  Ghosh, Amitav  Serving Knowledge Graphs Inferencing Notes and Further a:author  a:author  Reading http://…isbn/000651409X  http://…isbn/2020386682  a:price  a:price  a:price  a:price  rdf:value  p:currency  rdf:value  p:currency  rdf:value  p:currency  rdf:value  p:currency  33  :£  50  :€  60  :€  78  :$  (203)  203  4.38 BreakPage René Witte Introduction SELECT ?isbn ?price ?currency # note: not ?x!  Review WHERE {?isbn a:price ?x. ?x rdf:value ?price. ?x p:currency ?currency.}  OWL Queries SPARQL Queries Returns: [<…409X>,33,:£],  [<…409X>,50,:€], Introduction Describe                [<…6682>,60,:€] Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs a:name  Ghosh, Amitav  Serving Knowledge Graphs Inferencing Notes and Further a:author  a:author  Reading http://…isbn/000651409X  http://…isbn/2020386682  a:price  a:price  a:price  a:price  rdf:value  p:currency  rdf:value  p:currency  rdf:value  p:currency  rdf:value  p:currency  33  :£  50  :€  60  :€  78  :$  (204)  204  4.39 BreakPage René Witte Introduction SELECT ?isbn ?price ?currency # note: not ?x!  Review WHERE {?isbn a:price ?x. ?x rdf:value ?price. ?x p:currency ?currency.}  OWL Queries SPARQL Queries Returns: [<…409X>,33,:£],  [<…409X>,50,:€], Introduction Describe                [<…6682>,60,:€],  [<…6682>,78,:$] Select Construct Ask Other SPARQL Features SPARQL Protocol a:name  Ghosh, Amitav  Named Graphs Serving Knowledge Graphs Inferencing Notes and Further a:author  a:author  Reading http://…isbn/000651409X  http://…isbn/2020386682  a:price  a:price  a:price  a:price  rdf:value  p:currency  rdf:value  p:currency  rdf:value  p:currency  rdf:value  p:currency  33  :£  50  :€  60  :€  78  :$  →(205)  Worksheet #3: Task 4 205  4.40 BreakPage Outline René Witte Introduction 1 Introduction Review OWL Queries SPARQL Queries 2 SPARQL Queries Introduction Introduction Describe Select Describe Construct Ask Select Other SPARQL Features Construct SPARQL Protocol Named Graphs Ask Serving Knowledge Graphs Other SPARQL Features Inferencing Notes and Further Reading 3 SPARQL Protocol 4 Notes and Further Reading 4.41 BreakPage René Witte Introduction Review OWL Queries SPARQL Queries Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading Photo credit “reedster”, Flickr  4.42 BreakPage Introduction René Witte SPARQL W3C Standard SPARQL stands for. . . Introduction Review “SPARQL Protocol And RDF OWL Queries Query Language” SPARQL Queries Introduction Describe • Current version 1.1 (like RDF, RDFS, Select Construct etc.) Ask Other SPARQL Features • Language for querying graphs SPARQL Protocol • and a protocol for doing this over the Named Graphs Serving Knowledge Graphs web using a SPARQL endpoint Inferencing Notes and Further • Major difference between 1.0 and Reading 1.1: modifying graphs via SPARQL (insert, delete etc.) https://www.w3.org/TR/sparql11-query/ 4.43 BreakPage Describe René Witte Introduction Review Describing a resource OWL Simple query that can be used when no information about a graph’s content is Queries SPARQL Queries available. Introduction Describe Select Example 1 Construct Ask DESCRIBE <http://dbpedia.org/resource/Concordia_University> Other SPARQL Features SPARQL Protocol Example 2 Named Graphs Serving Knowledge Graphs Inferencing PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#> Notes and Further Reading PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> DESCRIBE ?s WHERE { ?s geo:lat "45.497002"^^xsd:float . ?s geo:long "-73.578003"^^xsd:float . } 4.44 BreakPage Public SPARQL Endpoint René Witte Introduction Review OWL Queries SPARQL Queries Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading → Worksheet #3: Task 5 4.45 BreakPage Selecting triples from a graph René Witte Probably the most widely used type of SPARQL query • Select triples from a graph that match a given triple pattern Introduction Review • Like an RDF triple, except subject, predicate, and/or object may be a variable OWL Queries SPARQL Queries Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading Copyright2011bySpringer-VerlagBerlinHeidelberg,[DFH11] 4.46 BreakPage Select. . . where René Witte Introduction Review OWL Queries SPARQL Queries Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading Copyright2013byO’ReillyMedia,[DuC13] 4.47 BreakPage Select: some details René Witte DISTINCT Introduction Review Use SELECT DISTINCT to remove redundant triples OWL Queries SPARQL Queries ORDER BY Introduction Use ORDER BY to sort the result triples (e.g., ORDER BY ?amount) Describe Select Construct LIMIT Ask Other SPARQL Features Use LIMIT to restrict the number of results (e.g., LIMIT 10) SPARQL Protocol Named Graphs Serving Knowledge Graphs Functions Inferencing You can use functions like AVG(), MIN(), MAX(), COUNT(), SUM(), e.g., Notes and Further Reading SELECT (MAX(?amount) as ?maxAmount) WHERE { ?meal e:amount ?amount . } → Worksheet #3: Task 6 4.48 BreakPage Union René Witte Introduction Review OWL Queries SPARQL Queries Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading Copyright2013byO’ReillyMedia,[DuC13] 4.49 BreakPage Union: Querying Alternatives René Witte Introduction Example (using the Gene Ontology) Review OWL “Find me the cellular processes that are either integral to or a reﬁnement of signal Queries transduction.” SPARQL Queries Introduction Describe PREFIX go: <http://purl.org/obo/owl/GO#> Select Construct PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> Ask Other SPARQL Features PREFIX obo: <http://www.obofoundry.org/ro/ro.owl#> SPARQL Protocol Named Graphs SELECT DISTINCT ?label ?process Serving Knowledge Graphs Inferencing WHERE { Notes and Further Reading { ?process obo:part_of go:GO_0007165 } # "integral to" UNION { ?process rdfs:subClassOf go:GO_0007165 } # "refinement of" ?process rdfs:label ?label } 4.50 BreakPage Optional René Witte Introduction Optional Information Review OWL Use the OPTIONAL keyword to match optional information, e.g., Queries SPARQL Queries prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> Introduction Describe prefix foaf: <http://xmlns.com/foaf/0.1/> Select Construct Ask select ?name ?url Other SPARQL Features where { SPARQL Protocol Named Graphs ?person foaf:name ?name . Serving Knowledge Graphs Inferencing OPTIONAL { ?person rdfs:seeAlso ?url } Notes and Further } Reading • This will return a person’s URL, if there is one • Without the OPTIONAL, persons without URLs would not have been matched 4.51 BreakPage René Witte Introduction SELECT ?isbn ?price ?currency ?wiki  Review WHERE { ?isbn a:price ?x. ?x rdf:value ?price. ?x p:currency ?currency.  OWL         OPTIONAL ?wiki w:isbn ?isbn. }  Queries SPARQL Queries Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs a:name  Ghosh, Amitav  http://en.wikipedia/…/The_Glass_Palace  Serving Knowledge Graphs Inferencing Notes and Further w:isbn  a:author  a:author  Reading http://…isbn/000651409X  http://…isbn/2020386682  a:price  a:price  a:price  a:price  rdf:value  p:currency  rdf:value  p:currency  rdf:value  p:currency  rdf:value  p:currency  33  :£  50  :€  60  :€  78  :$  (207)  207  4.52 BreakPage René Witte Introduction SELECT ?isbn ?price ?currency ?wiki  Review WHERE { ?isbn a:price ?x. ?x rdf:value ?price. ?x p:currency ?currency.  OWL         OPTIONAL ?wiki w:isbn ?isbn. }  Queries SPARQL Queries Introduction Returns:  [[<..09X>,33,:£,<…Palace>], … , [<..6682>,78,:$, ]] Describe Select Construct Ask Other SPARQL Features SPARQL Protocol a:name  Ghosh, Amitav  Named Graphs http://en.wikipedia/…/The_Glass_Palace  Serving Knowledge Graphs Inferencing w:isbn  a:author  a:author  NRoetaedsinagnd Further http://…isbn/000651409X  http://…isbn/2020386682  a:price  a:price  a:price  a:price  rdf:value  p:currency  rdf:value  p:currency  rdf:value  p:currency  rdf:value  p:currency  33  :£  50  :€  60  :€  78  :$  →(208)  Worksheet #3: Task 7 208  4.53 BreakPage Filter René Witte Introduction Filtering Information Review OWL Use a FILTER to remove results that were matched by WHERE, e.g.: Queries SPARQL Queries PREFIX dbr: <http://dbpedia.org/resource/> Introduction Describe PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> Select SELECT ?comment Construct Ask WHERE { Other SPARQL Features dbr:Linked_data rdfs:comment ?comment . SPARQL Protocol Named Graphs FILTER (lang(?comment) = "en") Serving Knowledge Graphs Inferencing } Notes and Further Reading • Here, we restrict all matched abstracts to those with an English language tag. • FILTERs can operate on numbers, strings, dates, URIs, or other data types and support regular expressions. 4.54 BreakPage René Witte Introduction SELECT ?isbn ?price ?currency # note: not ?x!  Review WHERE { ?isbn a:price ?x. ?x rdf:value ?price. ?x p:currency ?currency.  OWL         FILTER(?currency == :€) }  Queries SPARQL Queries Returns: [<…409X>,50,:€],  [<…6682>,60,:€] Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol a:name  Ghosh, Amitav  Named Graphs Serving Knowledge Graphs Inferencing Notes and Further a:author  a:author  Reading http://…isbn/000651409X  http://…isbn/2020386682  a:price  a:price  a:price  a:price  rdf:value  p:currency  rdf:value  p:currency  rdf:value  p:currency  rdf:value  p:currency  33  :£  50  :€  60  :€  78  :$  →(206)  Worksheet #3: Task 8 206  4.55 BreakPage Construct René Witte Introduction Review OWL Queries SPARQL Queries Introduction Describe Select Construct Constructing a new graph Ask Can be used to re-construct a new graph from an existing one. Other SPARQL Features SPARQL Protocol • For example, re-write triples from one vocabulary into another Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading 4.56 BreakPage René Witte Introduction CONSTRUCT { ?isbn b:price ?price.  Review             ?isbn a:author ?y. ?y a:name ?name . }  OWL WHERE { ?isbn a:price ?x. ?x rdf:value ?price. ?x p:currency ?currency.  Queries         ?isbn a:author ?y. ?y a:name ?name .  SPARQL Queries         FILTER(?currency == :€) }  Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs a:name  Ghosh, Amitav  Serving Knowledge Graphs Inferencing Notes and Further a:author  a:author  Reading http://…isbn/000651409X  http://…isbn/2020386682  a:price  a:price  a:price  a:price  rdf:value  p:currency  rdf:value  p:currency  rdf:value  p:currency  rdf:value  p:currency  33  :£  50  :€  60  :€  78  :$  (209)  209  4.57 BreakPage René Witte Introduction CONSTRUCT { ?isbn b:price ?price.  Review             ?isbn a:author ?y. ?y a:name ?name . }  OWL WHERE { ?isbn a:price ?x. ?x rdf:value ?price. ?x p:currency ?currency.  Queries         ?isbn a:author ?y. ?y a:name ?name .  SPARQL Queries         FILTER(?currency == :€) }  Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs a:name  Ghosh, Amitav  Serving Knowledge Graphs Inferencing Notes and Further a:author  a:author  Reading http://…isbn/000651409X  http://…isbn/2020386682  b:price  b:price  50  78  (210)  210  4.58 BreakPage Ask René Witte Asking a true/false question Introduction Review ASK <graph pattern> OWL Queries Returns true if the pattern can be matched in the graph, otherwise false SPARQL Queries Introduction Describe Example Select Construct Is Concordia University located in Mexico? Ask Other SPARQL Features PREFIX dbr: <http://dbpedia.org/resource/> SPARQL Protocol Named Graphs PREFIX dbo: <http://dbpedia.org/ontology/> Serving Knowledge Graphs Inferencing Notes and Further ASK { Reading dbr:Concordia_University dbo:country dbr:Mexico } → Worksheet #3: Task 9 4.59 BreakPage René Witte Introduction Review OWL Limit the number of returned results; remove  }  Queries SPARQL Queries duplicates, sort them, … Introduction Describe Specify several data sources (via URI-s) within the  Select }  Construct Ask query Other SPARQL Features SPARQL Protocol Construct a graph combining a separate pattern  Named Graphs }  Serving Knowledge Graphs Inferencing and the query results Notes and Further Reading Use datatypes and/or language tags when matching  }  a pattern Aggregation of the results (min, max, average, etc.) }  Path expressions (a bit like regular expressions) }  (211)  211  4.60 BreakPage René Witte Introduction Review OWL SPARQL is usually used over the network }  Queries SPARQL Queries §  http request is sent to a SPARQL endpoint Introduction Describe §  result is the result of the SELECT, the CONSTRUCT,… Select Construct Ask Separate documents deﬁne the protocol and the  }  Other SPARQL Features SPARQL Protocol result format Named Graphs Serving Knowledge Graphs •  SPARQL Protocol for RDF with HTTP and SOAP bindings Inferencing Notes and Further •  SPARQL results in XML or JSON formats Reading Big datasets usually offer “SPARQL endpoints”  }  using this protocol (212)  212  4.61 BreakPage René Witte Introduction Review GET /qps?&query=SELECT+:…+WHERE:+… HTTP/1.1  OWL User-Agent: my-sparql-client/0.0  Queries Host: my.example  SPARQL Queries           Introduction Describe HTTP/1.1 200 OK  Select Server: my-sparql-server/0.0  Construct Content-Type: application/sparql-results+xml  Ask   Other SPARQL Features <?xml version="1.0" encoding="UTF-8"?>  SPARQL Protocol <sparql xmlns="http://www.w3.org/2005/sparql-results#>  Named Graphs Serving Knowledge Graphs   <head>  Inferencing     <variable name="a"/>  Notes and Further     ...  Reading   </head>    <results>      <result ordered="false" distinct="false">        <binding name="a"><uri>http:…</uri></binding>        ...      </result>      <result> ... </result>    </results>  </sparql>  (213)  213  4.62 BreakPage René Witte Introduction Review OWL SPARQL CONSTRUCT returns a new, modiﬁed  }  Queries SPARQL Queries graph Introduction Describe §  the original data remains unchanged! Select Construct Ask }  SPARQL 1.1 Update modiﬁes the original dataset! Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading (214)  214  4.63 BreakPage René Witte Introduction INSERT {?isbn rdf:type frbr:Work}  Review WHERE  {?isbn a:price ?x. ?x rdf:value ?price. ?x p:currency ?currency.}  OWL Queries SPARQL Queries Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs a:name  Ghosh, Amitav  Serving Knowledge Graphs Inferencing Notes and Further a:author  a:author  Reading http://…isbn/000651409X  http://…isbn/2020386682  a:price  a:price  a:price  a:price  rdf:value  p:currency  rdf:value  p:currency  rdf:value  p:currency  rdf:value  p:currency  33  :£  50  :€  60  :€  78  :$  (215)  215  4.64 BreakPage René Witte Introduction INSERT {?isbn rdf:type frbr:Work}  Review WHERE  {?isbn a:price ?x. ?x rdf:value ?price. ?x p:currency ?currency.}  OWL Queries SPARQL Queries Introduction Describe frbr:Work  Select Construct Ask rdf:type  rdf:type  Other SPARQL Features SPARQL Protocol Named Graphs a:name  Ghosh, Amitav  Serving Knowledge Graphs Inferencing Notes and Further a:author  a:author  Reading http://…isbn/000651409X  http://…isbn/2020386682  a:price  a:price  a:price  a:price  rdf:value  p:currency  rdf:value  p:currency  rdf:value  p:currency  rdf:value  p:currency  33  :£  50  :€  60  :€  78  :$  (216)  216  4.65 BreakPage René Witte Introduction DELETE {?x p:currency ?currency}  Review WHERE  {?isbn a:price ?x. ?x rdf:value ?price. ?x p:currency ?currency.}  OWL Queries SPARQL Queries Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs a:name  Ghosh, Amitav  Serving Knowledge Graphs Inferencing Notes and Further a:author  a:author  Reading http://…isbn/000651409X  http://…isbn/2020386682  a:price  a:price  a:price  a:price  rdf:value  p:currency  rdf:value  p:currency  rdf:value  p:currency  rdf:value  p:currency  33  :£  50  :€  60  :€  78  :$  (217)  217  4.66 BreakPage René Witte Introduction DELETE {?x p:currency ?currency}  Review WHERE  {?isbn a:price ?x. ?x rdf:value ?price. ?x p:currency ?currency.}  OWL Queries SPARQL Queries Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs a:name  Ghosh, Amitav  Serving Knowledge Graphs Inferencing Notes and Further a:author  a:author  Reading http://…isbn/000651409X  http://…isbn/2020386682  a:price  a:price  a:price  a:price  rdf:value  rdf:value  rdf:value  rdf:value  33  50  60  78  (218)  218  4.67 BreakPage René Witte Introduction oint  Application  oint  ROeWvLiew dp dp Queries n n Triple store  PARQL E S P A R Q L   C o n s t r u c t   PARQL E Database  SIDSnPeetArlsoecRdcrtuiQbcetLionQueries S SPARQL Processor  S Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs s  Inferencing e qu Notes and Further ni F  Reading h D Tec R P  L L Q N S RDF Graph  Relational  Database  HTML  Unstructured Text  XML/XHTML  (219)  219  4.68 BreakPage Outline René Witte Introduction Review OWL 1 Introduction Queries SPARQL Queries Introduction 2 SPARQL Queries Describe Select Construct Ask 3 SPARQL Protocol Other SPARQL Features Named Graphs SPARQL Protocol Named Graphs Serving Knowledge Graphs Serving Knowledge Graphs Inferencing Inferencing Notes and Further Reading 4 Notes and Further Reading 4.69 BreakPage Named Graphs René Witte Introduction Review OWL Queries RDF Dataset SPARQL Queries Introduction An RDF dataset may have multiple named graphs and at most one unnamed Describe Select ("default") graph. Construct Ask Other SPARQL Features Serialization SPARQL Protocol Named Graphs TriG: Extension of Turtle for named graphs Serving Knowledge Graphs See https://www.w3.org/TR/trig/ Inferencing Notes and Further N-Quads: Extension of N-Triples for named graphs Reading See https://www.w3.org/TR/n-quads/ 4.70 BreakPage TriG Example René Witte BASE <http://example.org/> PREFIX ... Introduction GRAPH <http://example.org/bob> Review { OWL Queries <bob#me> SPARQL Queries a foaf:Person ; Introduction foaf:knows <alice#me> ; Describe schema:birthDate "1990-07-04"^^xsd:date ; Select Construct foaf:topic_interest wd:Q12418 . Ask } Other SPARQL Features SPARQL Protocol GRAPH <https://www.wikidata.org/wiki/Special:EntityData/Q12418> Named Graphs Serving Knowledge Graphs { Inferencing wd:Q12418 Notes and Further dcterms:title "Mona Lisa" ; Reading dcterms:creator <http://dbpedia.org/resource/Leonardo_da_Vinci> . <http://data.europeana.eu/item/04802/243FA8618938F4117025F17A8B813C5F9AA4D619> dcterms:subject wd:Q12418 . } <http://example.org/bob> dcterms:publisher <http://example.org> ; dcterms:rights <http://creativecommons.org/licenses/by/3.0/> . See https://www.w3.org/TR/rdf11-primer/ 4.71 BreakPage Named Graphs Example René Witte Introduction Review OWL Queries SPARQL Queries Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading https://www.w3.org/TR/rdf11-primer/ 4.72 BreakPage Named Graphs: N-Quads René Witte Introduction Review OWL N-Quads Queries SPARQL Queries N-Quads add a fourth element to a line, capturing the graph IRI of the triple Introduction described on that line Describe Select Construct Example Ask Other SPARQL Features <http://example.org/bob#me> ←(cid:45) SPARQL Protocol <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ←(cid:45) Named Graphs <http://xmlns.com/foaf/0.1/Person> <http://example.org/bob> . Serving Knowledge Graphs . . . Inferencing <http://www.wikidata.org/entity/Q12418> <http://purl.org/dc/terms/title> ←(cid:45) Notes and Further Reading "Mona Lisa" <https://www.wikidata.org/wiki/Special:EntityData/Q12418> . . . . <http://example.org/bob> <http://purl.org/dc/terms/rights> ←(cid:45) <http://creativecommons.org/licenses/by/3.0/> . 4.73 BreakPage RDF Datasets A SPARQL queries a default graph (normally) and zero or  René Witte more named graphs (when inside a GRAPH clause). Default graph PREFIX ex: <…> Introduction (the merge of zero or more graphs) SELECT … Review OWL FROM ex:g1 Queries ex:g1 FROM ex:g4 SPARQL Queries Introduction FROM NAMED ex:g1 Describe Select FROM NAMED ex:g2 Construct Ask ex:g4 FROM NAMED ex:g3 Other SPARQL Features WHERE { SPARQL Protocol Named Graphs … A … Serving Knowledge Graphs Named graphs GRAPH ex:g3 { Inferencing Notes and Further … B … Reading ex:g3 } ex:g1 GRAPH ?g { OR … C … OR } ex:g2 } 4.74 BreakPage Simple HTTP Request René Witte Introduction Review OWL Queries SPARQL Queries Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading Copyright2014byManningPublicationsCo.,[WZRH14] 4.75 BreakPage SPARQL Over HTTP (the SPARQL Protocol) René Witte http://host.domain.com/sparql/endpoint?<parameters> Introduction Review OWL where <parameters> can include: Queries SPARQL Queries Introduction Describe query=<encoded query string> Select Construct e.g. SELECT+*%0DWHERE+{… Ask Other SPARQL Features default-graph-uri=<encoded graph URI> SPARQL Protocol Named Graphs e.g. http%3A%2F%2Fexmaple.com%2Ffoo… Serving Knowledge Graphs Inferencing n.b. zero of more occurrences of default-graph-uri Notes and Further Reading named-graph-uri=<encoded graph URI> e.g. http%3A%2F%2Fexmaple.com%2Fbar… n.b. zero of more occurrences of named-graph-uri HTTP GET or POST. Graphs given in the protocol override graphs given in the  query. 4.76 BreakPage René Witte Federated Query  (SPARQL 1.1) Introduction PREFIX ex: <…> Review OWL Queries SELECT … SPARQL Queries Introduction FROM ex:g1 Describe Select ex:g1 WHERE { Construct Local Graph Store Ask Other SPARQL Features … A … SPARQL Protocol Named Graphs SERVICE ex:s1 { Serving Knowledge Graphs Inferencing SPARQL Endpoint … B … NRoetaedsinagnd Further ex:s1 } Web SERVICE ex:s2 { SPARQL Endpoint … C … ex:s2 } } 4.77 BreakPage SPARQL Server Engines René Witte Examples Commercial: Virtuoso (OpenLink Software); has “open source edition” at Introduction https://github.com/openlink/virtuoso-opensource Review OWL Cloud: Amazon AWS Neptune, see https://aws.amazon.com/neptune/ Queries SPARQL Queries Open Source: Apache Jena, see https://jena.apache.org/ Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading https://www.youtube.com/watch?v=Rl6UwE7kLio 4.78 BreakPage René Witte Introduction Review OWL Queries SPARQL Queries Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading See https://jena.apache.org/documentation/fuseki2/index.html 4.79 BreakPage Apache Fuseki (Standalone Server Mode) René Witte Introduction Review OWL Queries SPARQL Queries Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading 4.80 BreakPage René Witte Introduction Review OWL Queries SPARQL Queries Introduction Describe Select Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing Notes and Further Reading 4.81 BreakPage Inferencing René Witte Remember these. . . Introduction ex:Student rdfs:subClassOf foaf:Person Review OWL ex:Joe a ex:Student Queries SPARQL Queries What happens when you query for all foaf:Persons? Introduction Describe Select Construct Reasoning Engine Ask Other SPARQL Features • RDFlib will SPARQL Protocol return empty Named Graphs Serving Knowledge Graphs result Inferencing Notes and Further • Requires Reading inference support (e.g., RDFS reasoner, OWL reasoner) See https://jena.apache.org/documentation/inference/ 4.82 BreakPage René Witte Introduction SPARQL Engine with entailment  Review OWL Queries RDF Data  SPARQL Queries Introduction RDFS/OWL/RIF  entailment  Describe data  Select SPARQL Pattern  Construct Ask Other SPARQL Features SPARQL Protocol Named Graphs Serving Knowledge Graphs RDF Data with extra triples  Inferencing Notes and Further SPARQL Pattern  Reading pattern  Query  result  matching  (349)  349  4.83 BreakPage Outline René Witte Introduction Review OWL Queries 1 Introduction SPARQL Queries Introduction Describe 2 SPARQL Queries Select Construct Ask Other SPARQL Features 3 SPARQL Protocol SPARQL Protocol Named Graphs Serving Knowledge Graphs Inferencing 4 Notes and Further Reading Notes and Further Reading 4.84 BreakPage Reading Material René Witte Introduction Review OWL Queries SPARQL Queries Required Introduction Describe • [Yu14, Chapter 6] (SPARQL) Select Construct Ask Other SPARQL Features Supplemental SPARQL Protocol Named Graphs • [DuC13] (Learning SPARQL) Serving Knowledge Graphs Inferencing • [WZRH14, Chapter 5] (SPARQL) Notes and Further Reading • SPARQL 1.1 Overview, https://www.w3.org/TR/sparql11-overview/ 4.85 BreakPage References I René Witte [DFH11] John Domingue, Dieter Fensel, and James A. Hendler, editors. Introduction Review Handbook of Semantic Web Technologies. OWL Springer, 2011. Queries SPARQL Queries https://concordiauniversity.on.worldcat.org/oclc/769756125. Introduction Describe [DuC13] Bob DuCharme. Select Construct Learning SPARQL: Querying and Updating with SPARQL 1.1. Ask Other SPARQL Features O’Reilly, 2nd edition, 2013. SPARQL Protocol https://concordiauniversity.on.worldcat.org/oclc/853679890. Named Graphs Serving Knowledge Graphs Inferencing [Her] Ivan Herman. Notes and Further Tutorial on Semantic Web Technologies. Reading http://www.w3.org/People/Ivan/CorePresentations/RDFTutorial/. [WZRH14] David Wood, Marsha Zaidman, Luke Ruth, and Michael Hausenblas. Linked Data: Structured Data on the Web. Manning, 2014. https://concordiauniversity.on.worldcat.org/oclc/871683907. 4.86 BreakPage References II René Witte Introduction Review OWL Queries SPARQL Queries Introduction Describe Select [Yu14] Liyang Yu. Construct Ask A Developer’s Guide to the Semantic Web. Other SPARQL Features Springer-Verlag Berlin Heidelberg, 2nd edition, 2014. SPARQL Protocol Named Graphs https://concordiauniversity.on.worldcat.org/oclc/897466408. Serving Knowledge Graphs Inferencing Notes and Further Reading 4.87 BreakPage 